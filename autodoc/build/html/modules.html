<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>&gt; Modules &#8212; Bismuth Hypernodes 0.1 documentation</title>
    
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '0.1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&gt; Bismuth Hypernodes" href="hypernode.html" />
    <link rel="prev" title="Welcome to Bismuth Hypernodes’s documentation!" href="index.html" /> 
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypernode.html" title="&gt; Bismuth Hypernodes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Bismuth Hypernodes’s documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bismuth Hypernodes 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modules">
<h1>&gt; Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="module-config">
<span id="config-constants-and-settings"></span><h1>config - Constants and settings<a class="headerlink" href="#module-config" title="Permalink to this headline">¶</a></h1>
<p>Bismuth
Common variables for PoS</p>
<p>Also serves as config file for POC and tests</p>
<dl class="data">
<dt id="config.GENESIS_SIGNATURE">
<code class="descclassname">config.</code><code class="descname">GENESIS_SIGNATURE</code><em class="property"> = ''</em><a class="headerlink" href="#config.GENESIS_SIGNATURE" title="Permalink to this definition">¶</a></dt>
<dd><p>DEBUG VARS</p>
</dd></dl>

<dl class="data">
<dt id="config.POC_LAST_BROADHASH">
<code class="descclassname">config.</code><code class="descname">POC_LAST_BROADHASH</code><em class="property"> = b'123456789abcdef12345'</em><a class="headerlink" href="#config.POC_LAST_BROADHASH" title="Permalink to this definition">¶</a></dt>
<dd><p>Here comes tuneable algorithm variables - Do not change those or you will fork or be unable to sync</p>
</dd></dl>

<dl class="data">
<dt id="config.POW_LEDGER_DB">
<code class="descclassname">config.</code><code class="descname">POW_LEDGER_DB</code><em class="property"> = '../../Bismuth-master/static/ledger.db'</em><a class="headerlink" href="#config.POW_LEDGER_DB" title="Permalink to this definition">¶</a></dt>
<dd><p>Here comes temp. PoC variables</p>
</dd></dl>

<dl class="data">
<dt id="config.PROCESS_TIMEOUT">
<code class="descclassname">config.</code><code class="descname">PROCESS_TIMEOUT</code><em class="property"> = 15</em><a class="headerlink" href="#config.PROCESS_TIMEOUT" title="Permalink to this definition">¶</a></dt>
<dd><p>Global Variables</p>
</dd></dl>

<dl class="function">
<dt id="config.load">
<code class="descclassname">config.</code><code class="descname">load</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#config.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Overload info with config.default.txt and config.txt
:return:</p>
</dd></dl>

<dl class="function">
<dt id="config.overload">
<code class="descclassname">config.</code><code class="descname">overload</code><span class="sig-paren">(</span><em>file_name: str</em><span class="sig-paren">)</span><a class="headerlink" href="#config.overload" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="poshn-core-hypernode-class">
<h1>poshn - core hypernode class<a class="headerlink" href="#poshn-core-hypernode-class" title="Permalink to this headline">¶</a></h1>
<p>The Core Hypernode server class.</p>
<span class="target" id="module-poshn"></span><p>Pos Hypernode class for Bismuth Cryptocurrency
Tornado based</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>TODO: are prioritary actions TBD
FR: are features request. Think of them as second class TO DO items that are less urgent
FR: will go into TODO: as TODO: is cleared.</dd>
</dl>
<dl class="class">
<dt id="poshn.HNState">
<em class="property">class </em><code class="descclassname">poshn.</code><code class="descname">HNState</code><a class="headerlink" href="#poshn.HNState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">enum.Enum</span></code></p>
<p>Current State of the HN</p>
<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_CONNECT1">
<code class="descname">CATCHING_UP_CONNECT1</code><em class="property"> = 7</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_CONNECT1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_CONNECT2">
<code class="descname">CATCHING_UP_CONNECT2</code><em class="property"> = 8</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_CONNECT2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_ELECT">
<code class="descname">CATCHING_UP_ELECT</code><em class="property"> = 9</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_ELECT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_PRESYNC">
<code class="descname">CATCHING_UP_PRESYNC</code><em class="property"> = 10</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_PRESYNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_SYNC">
<code class="descname">CATCHING_UP_SYNC</code><em class="property"> = 11</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_SYNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.FORGING">
<code class="descname">FORGING</code><em class="property"> = 5</em><a class="headerlink" href="#poshn.HNState.FORGING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.MINIMAL_CONSENSUS">
<code class="descname">MINIMAL_CONSENSUS</code><em class="property"> = 4</em><a class="headerlink" href="#poshn.HNState.MINIMAL_CONSENSUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.ROUND_SYNC">
<code class="descname">ROUND_SYNC</code><em class="property"> = 12</em><a class="headerlink" href="#poshn.HNState.ROUND_SYNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.SENDING">
<code class="descname">SENDING</code><em class="property"> = 6</em><a class="headerlink" href="#poshn.HNState.SENDING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.START">
<code class="descname">START</code><em class="property"> = 0</em><a class="headerlink" href="#poshn.HNState.START" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.STRONG_CONSENSUS">
<code class="descname">STRONG_CONSENSUS</code><em class="property"> = 3</em><a class="headerlink" href="#poshn.HNState.STRONG_CONSENSUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.SYNCING">
<code class="descname">SYNCING</code><em class="property"> = 1</em><a class="headerlink" href="#poshn.HNState.SYNCING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.TESTING">
<code class="descname">TESTING</code><em class="property"> = 2</em><a class="headerlink" href="#poshn.HNState.TESTING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.HNState._generate_next_value_">
<code class="descname">_generate_next_value_</code><span class="sig-paren">(</span><em>name</em>, <em>start</em>, <em>count</em>, <em>last_values</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HNState._generate_next_value_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState._member_map_">
<code class="descname">_member_map_</code><em class="property"> = OrderedDict([('START', &lt;HNState.START: 0&gt;), ('SYNCING', &lt;HNState.SYNCING: 1&gt;), ('TESTING', &lt;HNState.TESTING: 2&gt;), ('STRONG_CONSENSUS', &lt;HNState.STRONG_CONSENSUS: 3&gt;), ('MINIMAL_CONSENSUS', &lt;HNState.MINIMAL_CONSENSUS: 4&gt;), ('FORGING', &lt;HNState.FORGING: 5&gt;), ('SENDING', &lt;HNState.SENDING: 6&gt;), ('CATCHING_UP_CONNECT1', &lt;HNState.CATCHING_UP_CONNECT1: 7&gt;), ('CATCHING_UP_CONNECT2', &lt;HNState.CATCHING_UP_CONNECT2: 8&gt;), ('CATCHING_UP_ELECT', &lt;HNState.CATCHING_UP_ELECT: 9&gt;), ('CATCHING_UP_PRESYNC', &lt;HNState.CATCHING_UP_PRESYNC: 10&gt;), ('CATCHING_UP_SYNC', &lt;HNState.CATCHING_UP_SYNC: 11&gt;), ('ROUND_SYNC', &lt;HNState.ROUND_SYNC: 12&gt;)])</em><a class="headerlink" href="#poshn.HNState._member_map_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState._member_names_">
<code class="descname">_member_names_</code><em class="property"> = ['START', 'SYNCING', 'TESTING', 'STRONG_CONSENSUS', 'MINIMAL_CONSENSUS', 'FORGING', 'SENDING', 'CATCHING_UP_CONNECT1', 'CATCHING_UP_CONNECT2', 'CATCHING_UP_ELECT', 'CATCHING_UP_PRESYNC', 'CATCHING_UP_SYNC', 'ROUND_SYNC']</em><a class="headerlink" href="#poshn.HNState._member_names_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState._member_type_">
<code class="descname">_member_type_</code><a class="headerlink" href="#poshn.HNState._member_type_" title="Permalink to this definition">¶</a></dt>
<dd><p>alias of <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
</dd></dl>

<dl class="attribute">
<dt id="poshn.HNState._value2member_map_">
<code class="descname">_value2member_map_</code><em class="property"> = {0: &lt;HNState.START: 0&gt;, 1: &lt;HNState.SYNCING: 1&gt;, 2: &lt;HNState.TESTING: 2&gt;, 3: &lt;HNState.STRONG_CONSENSUS: 3&gt;, 4: &lt;HNState.MINIMAL_CONSENSUS: 4&gt;, 5: &lt;HNState.FORGING: 5&gt;, 6: &lt;HNState.SENDING: 6&gt;, 7: &lt;HNState.CATCHING_UP_CONNECT1: 7&gt;, 8: &lt;HNState.CATCHING_UP_CONNECT2: 8&gt;, 9: &lt;HNState.CATCHING_UP_ELECT: 9&gt;, 10: &lt;HNState.CATCHING_UP_PRESYNC: 10&gt;, 11: &lt;HNState.CATCHING_UP_SYNC: 11&gt;, 12: &lt;HNState.ROUND_SYNC: 12&gt;}</em><a class="headerlink" href="#poshn.HNState._value2member_map_" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="poshn.HnServer">
<em class="property">class </em><code class="descclassname">poshn.</code><code class="descname">HnServer</code><a class="headerlink" href="#poshn.HnServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">tornado.tcpserver.TCPServer</span></code></p>
<p>Tornado asynchronous TCP server.</p>
<dl class="method">
<dt id="poshn.HnServer._handle_msg">
<code class="descname">_handle_msg</code><span class="sig-paren">(</span><em>msg</em>, <em>stream</em>, <em>peer_ip</em>, <em>peer_port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HnServer._handle_msg" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Handles a single command received by the server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>msg</strong> &#8211; </li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>peer_ip</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.HnServer.handle_stream">
<code class="descname">handle_stream</code><span class="sig-paren">(</span><em>stream</em>, <em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HnServer.handle_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Handles the lifespan of a client, from connection to end of stream</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream</strong> &#8211; </li>
<li><strong>address</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.HnServer.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>url</em>, <em>stream</em>, <em>peer_ip</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HnServer.update" title="Permalink to this definition">¶</a></dt>
<dd><p>Update process when an &#8216;update&#8217; message
from an authorized source is received.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>url</strong> &#8211; </li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>peer_ip</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="poshn.Poshn">
<em class="property">class </em><code class="descclassname">poshn.</code><code class="descname">Poshn</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>address=''</em>, <em>peers=None</em>, <em>verbose=False</em>, <em>outip='127.0.0.1'</em>, <em>wallet='poswallet.json'</em>, <em>datadir='data'</em>, <em>suffix=''</em>, <em>version=''</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The PoS Hypernode object</p>
<dl class="method">
<dt id="poshn.Poshn._consensus">
<code class="descname">_consensus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._consensus" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Returns the % of jurors we agree with</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">double</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._exchange_height">
<code class="descname">_exchange_height</code><span class="sig-paren">(</span><em>stream</em>, <em>full_peer</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._exchange_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Send our height info to a peer, and process his in return.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stream</strong> &#8211; </li>
<li><strong>full_peer</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._exchange_mempool">
<code class="descname">_exchange_mempool</code><span class="sig-paren">(</span><em>stream</em>, <em>full_peer</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._exchange_mempool" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Send our mempool to a peer, and process his in return.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>stream</strong> &#8211; </li>
<li><strong>full_peer</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._get_peer_stream">
<code class="descname">_get_peer_stream</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>temp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._get_peer_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Return a stream with communication already established.
Stream has to be closed after use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ip</strong> &#8211; 127.0.0.1</li>
<li><strong>port</strong> &#8211; 6969</li>
<li><strong>temp</strong> &#8211; True - For temps commands, uses a fake 00000 port as self id.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">IOStream</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._get_round_blocks">
<code class="descname">_get_round_blocks</code><span class="sig-paren">(</span><em>peer</em>, <em>a_round</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._get_round_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Request full blocks from a full (or partial) round from a given peer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>peer</strong> &#8211; </li>
<li><strong>a_round</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of blocks</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._new_tx">
<code class="descname">_new_tx</code><span class="sig-paren">(</span><em>recipient=''</em>, <em>what=0</em>, <em>params=''</em>, <em>value=0</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._new_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert a new TX (message) in the local mempool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>recipient</strong> &#8211; </li>
<li><strong>what</strong> &#8211; </li>
<li><strong>params</strong> &#8211; </li>
<li><strong>value</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._round_sync">
<code class="descname">_round_sync</code><span class="sig-paren">(</span><em>a_round</em>, <em>promised_height</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._round_sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Tries to sync from a peer advertising a better chain than ours.
BEWARE: this is only ok if the peer is a juror for the current round.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a_round</strong> &#8211; Round # to fetch</li>
<li><strong>promised_height</strong> &#8211; dict of the supposedly best available height</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean (success)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._update_network">
<code class="descname">_update_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._update_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Adjust peers and network properties, calc _consensus()
Always called from the manager co-routine only.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.add_inbound">
<code class="descname">add_inbound</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>properties=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.add_inbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely add a distant peer from server co-routine.
This is called only after initial exchange and approval.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ip</strong> &#8211; </li>
<li><strong>port</strong> &#8211; </li>
<li><strong>properties</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.change_state_to">
<code class="descname">change_state_to</code><span class="sig-paren">(</span><em>new_state</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.change_state_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Sets new status and logs change.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_state</strong> &#8211; </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.check_os">
<code class="descname">check_os</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.check_os" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.check_round">
<code class="descname">check_round</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.check_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Adjust round/slots depending properties.
Always called from the manager co-routine only.
Should not be called too often (1-10sec should be plenty)</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.client_worker">
<code class="descname">client_worker</code><span class="sig-paren">(</span><em>peer</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.client_worker" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Client worker, running in a co-routine.
Tries to connect to the given peer, terminates on error and deletes itself on close.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>peer</strong> &#8211; (&#8216;aa012345678901aa&#8217;, &#8216;127.0.0.1&#8217;, 6969, 1)</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="poshn.Poshn.clients">
<code class="descname">clients</code><em class="property"> = {}</em><a class="headerlink" href="#poshn.Poshn.clients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><em>connect=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the &#8220;Shall I try to connect?&#8221; flag</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>connect</strong> &#8211; </td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.digest_height">
<code class="descname">digest_height</code><span class="sig-paren">(</span><em>height_proto</em>, <em>full_peer</em>, <em>server=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.digest_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Update inner properties with distant peer height info.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>height_proto</strong> &#8211; protobuff structure</li>
<li><strong>full_peer</strong> &#8211; </li>
<li><strong>server</strong> &#8211; comes from the server (inbound) or client (outbound) side?</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.digest_txs">
<code class="descname">digest_txs</code><span class="sig-paren">(</span><em>txs</em>, <em>peer_ip</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.digest_txs" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Checks tx and digest if they are new.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>txs</strong> &#8211; </li>
<li><strong>peer_ip</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.do_test_peer">
<code class="descname">do_test_peer</code><span class="sig-paren">(</span><em>proto_block</em>, <em>peer_ip</em>, <em>peer_port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.do_test_peer" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Send the test block to a given peer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proto_block</strong> &#8211; a protobuf block</li>
<li><strong>peer_ip</strong> &#8211; the peer ip</li>
<li><strong>peer_port</strong> &#8211; the peer port</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the answer from the peer</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.forge">
<code class="descname">forge</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.forge" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Consensus has been reached, we are forger, forge and send block.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.get_heights">
<code class="descname">get_heights</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.get_heights" title="Permalink to this definition">¶</a></dt>
<dd><p>Return dict of known peers heights.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.get_hypernodes">
<code class="descname">get_hypernodes</code><span class="sig-paren">(</span><em>param</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.get_hypernodes" title="Permalink to this definition">¶</a></dt>
<dd><p>Return list of registered and active Hypernodes with metrics.</p>
<p>param is an optional string param &#8220;full,start_round,end_round&#8221; where full is &#8220;0&#8221; or &#8220;1&#8221;.</p>
<p>If full is set to &#8220;1&#8221;, a dict is return instead of a list, with full metrics of each Hypernode for the given period.
:param param:
:return:</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.hello_string">
<code class="descname">hello_string</code><span class="sig-paren">(</span><em>temp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.hello_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds up the hello string.
common.POSNET + str(port).zfill(5) + self.address</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>temp</strong> &#8211; True - For one shot commands, from an already connected ip, uses a fake 00000 port as self id.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="poshn.Poshn.inbound">
<code class="descname">inbound</code><em class="property"> = {}</em><a class="headerlink" href="#poshn.Poshn.inbound" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.init_check">
<code class="descname">init_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.init_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial coherence check. Raise on non coherent info.
#&nbsp;FR: more checks</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.init_log">
<code class="descname">init_log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.init_log" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the log related objects.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.manager">
<code class="descname">manager</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Async Manager co-routine. Responsible for managing inner state of the node.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.post_block">
<code class="descname">post_block</code><span class="sig-paren">(</span><em>proto_block</em>, <em>peer_ip</em>, <em>peer_port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.post_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Send the block we forged to a given peer
Should we use threads instead and a simpler tcp client? Perfs to be tested.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>proto_block</strong> &#8211; a protobuf block</li>
<li><strong>peer_ip</strong> &#8211; the peer ip</li>
<li><strong>peer_port</strong> &#8211; the peer port</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.refresh_last_block">
<code class="descname">refresh_last_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.refresh_last_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Fetch fresh info from the PoS chain.
Update the inner properties.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.remove_inbound">
<code class="descname">remove_inbound</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.remove_inbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely remove a distant peer from server co-routine.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ip</strong> &#8211; </li>
<li><strong>port</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.round_status">
<code class="descname">round_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#poshn.Poshn.round_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Assemble and store the current round status as a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Round Status info</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.run_test_peer">
<code class="descname">run_test_peer</code><span class="sig-paren">(</span><em>test</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.run_test_peer" title="Permalink to this definition">¶</a></dt>
<dd><p>Run a single test of a given peer, and store the result in a new transaction.
TODO: check (local cache or chain) that this test was not already done.
Edge case of a node that is restarted then does the tests again because it&#8217;s still the same slot.
Like a temp dir, with json of this round tests only. Keep a version in ram, and save to disk, so we can reload on start.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>test</strong> &#8211; tuple (from, recipient, test id)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.serve">
<code class="descname">serve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.serve" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the Tornado socket server.
Once we called that, the calling thread is stopped until the server closes.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.status">
<code class="descname">status</code><span class="sig-paren">(</span><em>log: bool = True</em><span class="sig-paren">)</span> &#x2192; dict<a class="headerlink" href="#poshn.Poshn.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Assemble and store the node status as a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">HN Status info</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal to stop as cleanly as possible.</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.update_inbound">
<code class="descname">update_inbound</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>properties</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.update_inbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely update info for a connected peer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>ip</strong> &#8211; </li>
<li><strong>port</strong> &#8211; </li>
<li><strong>properties</strong> &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="poshn.REUSE_PORT">
<code class="descclassname">poshn.</code><code class="descname">REUSE_PORT</code><em class="property"> = False</em><a class="headerlink" href="#poshn.REUSE_PORT" title="Permalink to this definition">¶</a></dt>
<dd><p>TCP Server Class</p>
</dd></dl>

</div>
<div class="section" id="poschain-pos-chain-abstraction-class">
<h1>poschain - PoS chain abstraction class<a class="headerlink" href="#poschain-pos-chain-abstraction-class" title="Permalink to this headline">¶</a></h1>
<p>An abstraction class used by poshn.</p>
<span class="target" id="module-poschain"></span><p>A Safe thread/process object interfacing the PoS chain</p>
<dl class="data">
<dt id="poschain.SQL_CREATE_POS_ROUNDS">
<code class="descclassname">poschain.</code><code class="descname">SQL_CREATE_POS_ROUNDS</code><em class="property"> = 'CREATE TABLE pos_rounds (    round      INTEGER PRIMARY KEY,    active_hns TEXT,    slots      STRING,    test_slots STRING    );'</em><a class="headerlink" href="#poschain.SQL_CREATE_POS_ROUNDS" title="Permalink to this definition">¶</a></dt>
<dd><dl class="docutils">
<dt>SQL_INSERT_GENESIS = &#8220;INSERT INTO pos_chain (forger, received_by, block_hash,</dt>
<dd><blockquote class="first">
<div><blockquote>
<div>signature, uniques_sources, msg_count, previous_hash,timestamp, sir, round, height) VALUES (&#8216;BLYkQwGZmwjsh7DY6HmuNBpTbqoRqX14ne&#8217;,NULL,X&#8216;9094D7B35AC3E924C20545486F75D6E10C8B1EA7&#8217;,X&#8216;323C6766C8C0267C6CB5B8D4161F1D4E0F7DB0F64DD52942A086240AE9561B2D2A3E1DC91FEBBF83C636E7E092931E8FD96E2EB4103BA466C225128A6339F9B7&#8217;,0,0,X&#8217;C0CB310E2877D73E2F29A949AABB8FEF0EA00EDF&#8217;,1522419000,0,0,0</div></blockquote>
<p>);</p>
</div></blockquote>
<p class="last">&#8220;</p>
</dd>
</dl>
</dd></dl>

<dl class="data">
<dt id="poschain.SQL_ROUNDS_SOURCES">
<code class="descclassname">poschain.</code><code class="descname">SQL_ROUNDS_SOURCES</code><em class="property"> = 'SELECT DISTINCT(sender) FROM pos_messages WHERE block_height &gt;= ? AND block_height &lt;= ?'</em><a class="headerlink" href="#poschain.SQL_ROUNDS_SOURCES" title="Permalink to this definition">¶</a></dt>
<dd><p>pos chain db structure</p>
</dd></dl>

<dl class="class">
<dt id="poschain.SqlitePosChain">
<em class="property">class </em><code class="descclassname">poschain.</code><code class="descname">SqlitePosChain</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>db_path='data/'</em>, <em>app_log=None</em>, <em>mempool=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#sqlitebase.SqliteBase" title="sqlitebase.SqliteBase"><code class="xref py py-class docutils literal"><span class="pre">sqlitebase.SqliteBase</span></code></a></p>
<dl class="method">
<dt id="poschain.SqlitePosChain._height_status">
<code class="descname">_height_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._height_status" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a BlockHeight object with our current state</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain._insert_block">
<code class="descname">_insert_block</code><span class="sig-paren">(</span><em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._insert_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves block object to file db</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block</strong> &#8211; a native PosBlock object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain._insert_block_old">
<code class="descname">_insert_block_old</code><span class="sig-paren">(</span><em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._insert_block_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves block object to file db</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block</strong> &#8211; a native PosBlock object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain._invalidate">
<code class="descname">_invalidate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._invalidate" title="Permalink to this definition">¶</a></dt>
<dd><p>Something changed in our chain, invalidate the status.
It will then be recalc when needed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain._last_block">
<code class="descname">_last_block</code><span class="sig-paren">(</span><em>with_tx=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._last_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns last know block as a dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_active_hns">
<code class="descname">async_active_hns</code><span class="sig-paren">(</span><em>start_round</em>, <em>end_round=0</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_active_hns" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a list of active HN for the round range.
:param start_round:
:param end_round: optional, will use start_round if = 0
:return: list of PoS addresses</p>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_blockinfo">
<code class="descname">async_blockinfo</code><span class="sig-paren">(</span><em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_blockinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns partial height info of a given block</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_blocksync">
<code class="descname">async_blocksync</code><span class="sig-paren">(</span><em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_blocksync" title="Permalink to this definition">¶</a></dt>
<dd><p>returns N blocks starting with the given height.</p>
<p>FR: Harmonize. this one needs a proto as output (proto command with list of blocks)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>height</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_getaddtxs">
<code class="descname">async_getaddtxs</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_getaddtxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 15
returns a list of txs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> &#8211; str: an address or address,extra</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with the txs list or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_getblock">
<code class="descname">async_getblock</code><span class="sig-paren">(</span><em>a_height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_getblock" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 14
returns the block of the given height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a_height</strong> &#8211; int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with the block if exists or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_getheaders">
<code class="descname">async_getheaders</code><span class="sig-paren">(</span><em>param</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_getheaders" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Return 20 latest block headers.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>param</strong> &#8211; (string) empty: last 20 blocks headers. start_height,count or ,count (last N headers)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_gettx">
<code class="descname">async_gettx</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_gettx" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 16
returns the tx or empty protocmd.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> &#8211; str: a transaction signature</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with the tx or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_height">
<code class="descname">async_height</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a BlockHeight object with our current state</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_roundblocks">
<code class="descname">async_roundblocks</code><span class="sig-paren">(</span><em>a_round</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_roundblocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 13
returns all blocks of the given round.</p>
<p>FR: Harmonize. this one needs a proto as output (proto command with list of blocks)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a_round</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with all blocks</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.check">
<code class="descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks and creates db. This is not async yet, so we close afterward.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.check_round">
<code class="descname">check_round</code><span class="sig-paren">(</span><em>a_round</em>, <em>blocks</em>, <em>fast_check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.check_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a round number and all blocks for this round, checks that these blocks are valid candidates.
Does not modify the chain, can be used on existing current round to check validity alternate chains.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a_round</strong> &#8211; </li>
<li><strong>blocks</strong> &#8211; a PosBlock object</li>
<li><strong>fast_check</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a height dict, containing the simulated final state of the chain, or False if blocks are not valid.</p>
</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal"><span class="pre">{'height':</span> <span class="pre">3631,</span> <span class="pre">'round':</span> <span class="pre">6420,</span> <span class="pre">'sir':</span> <span class="pre">1,</span> <span class="pre">'block_hash':</span> <span class="pre">'a03ffeea35a48f0773bc993289213c3c72165ee0',</span>
<span class="pre">'uniques':</span> <span class="pre">4,</span> <span class="pre">'uniques_round':</span> <span class="pre">0,</span> <span class="pre">'forgers':</span> <span class="pre">4,</span> <span class="pre">'forgers_round':</span> <span class="pre">1,</span> <span class="pre">'count':</span> <span class="pre">0,</span> <span class="pre">'peers':</span> <span class="pre">[]'</span></code></p>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.delete_round">
<code class="descname">delete_round</code><span class="sig-paren">(</span><em>a_round</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.delete_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove round and transactions data for this round
The caller is responsible for updating state if necessary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a_round</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.digest_block">
<code class="descname">digest_block</code><span class="sig-paren">(</span><em>proto_block</em>, <em>from_miner=False</em>, <em>relaxed_checks=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.digest_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the block is valid and saves it</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proto_block</strong> &#8211; a protobuf &#8216;block&#8217; object</li>
<li><strong>from_miner</strong> &#8211; True if came from a live miner (current slot)</li>
<li><strong>relaxed_checks</strong> &#8211; True if we want light checks (like our own block)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.genesis_block">
<code class="descname">genesis_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.genesis_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Build up genesis block info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.last_block">
<code class="descname">last_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.last_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns last know block as a dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.rollback">
<code class="descname">rollback</code><span class="sig-paren">(</span><em>block_count=1</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>revert latest block_count blocks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.tx_exists">
<code class="descname">tx_exists</code><span class="sig-paren">(</span><em>txid</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.tx_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if the given txid is in our chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="posblock-pos-block-abstraction-class">
<h1>posblock - PoS block abstraction class<a class="headerlink" href="#posblock-pos-block-abstraction-class" title="Permalink to this headline">¶</a></h1>
<p>An abstraction class used by poschain.</p>
<span class="target" id="module-posblock"></span><p>An object representing a PoS block and its transaction
Allow for different formats: json, dict, raw, protobuf
and conversion between them all.</p>
<dl class="class">
<dt id="posblock.PosBlock">
<em class="property">class </em><code class="descclassname">posblock.</code><code class="descname">PosBlock</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="posblock.PosBlock.add_to_proto">
<code class="descname">add_to_proto</code><span class="sig-paren">(</span><em>protocmd</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.add_to_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the block to an existing protobuf command object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.from_dict">
<code class="descname">from_dict</code><span class="sig-paren">(</span><em>block_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a dict representing a block to the native object format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block_dict</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.from_proto">
<code class="descname">from_proto</code><span class="sig-paren">(</span><em>block_proto</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.from_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Inits the instance properties with the provided protobuff data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block_proto</strong> &#8211; a protobuff object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="posblock.PosBlock.hex_encodable">
<code class="descname">hex_encodable</code><em class="property"> = ('previous_hash', 'block_hash', 'signature')</em><a class="headerlink" href="#posblock.PosBlock.hex_encodable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.old_digest_block">
<code class="descname">old_digest_block</code><span class="sig-paren">(</span><em>block</em>, <em>timestamp=0</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.old_digest_block" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="posblock.PosBlock.props">
<code class="descname">props</code><em class="property"> = ('height', 'round', 'sir', 'timestamp', 'previous_hash', 'msg_count', 'uniques_sources', 'signature', 'block_hash', 'received_by', 'forger')</em><a class="headerlink" href="#posblock.PosBlock.props" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.sign">
<code class="descname">sign</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign the raw block and calc it&#8217;s hash</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">signature, bytearray</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.to_db">
<code class="descname">to_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.to_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple representation of the block object for db insert, without tx. In the db order, with binary types.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><em>as_hex=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the native object format to a dict representing a block.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>as_hex</strong> &#8211; if True, will convert binary fields to hex encoded string</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.to_json">
<code class="descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a json representation of the current block object
with <em>binary content as hex encoded string</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.to_proto">
<code class="descname">to_proto</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.to_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a protobuf object from current native format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">a protobuf object.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosBlock.to_raw">
<code class="descname">to_raw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosBlock.to_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Gives a raw binary buffer image of the signed block elements.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">bytearray</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="posblock.PosHeight">
<em class="property">class </em><code class="descclassname">posblock.</code><code class="descname">PosHeight</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosHeight" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>PoS Height is the status of the chain state.
This object represents the current height and content of a given node.</p>
<dl class="method">
<dt id="posblock.PosHeight.from_dict">
<code class="descname">from_dict</code><span class="sig-paren">(</span><em>height_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosHeight.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a dict to the native object format</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>height_dict</strong> &#8211; dict()</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosHeight.from_proto">
<code class="descname">from_proto</code><span class="sig-paren">(</span><em>height_proto</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosHeight.from_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates from a protobuf Height object.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">self</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="posblock.PosHeight.hex_encodable">
<code class="descname">hex_encodable</code><em class="property"> = ('block_hash',)</em><a class="headerlink" href="#posblock.PosHeight.hex_encodable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="posblock.PosHeight.props">
<code class="descname">props</code><em class="property"> = ('height', 'round', 'sir', 'block_hash', 'uniques', 'uniques_round', 'forgers', 'forgers_round')</em><a class="headerlink" href="#posblock.PosHeight.props" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posblock.PosHeight.to_dict">
<code class="descname">to_dict</code><span class="sig-paren">(</span><em>as_hex=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosHeight.to_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts the native object format to a dict representing a height status</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>as_hex</strong> &#8211; convert raw buffers to hex string encoding so we can json_encode later.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">dict()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosHeight.to_proto">
<code class="descname">to_proto</code><span class="sig-paren">(</span><em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosHeight.to_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Fills in the protobuf object &#8220;Height&#8221; section</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="posblock.PosMessage">
<em class="property">class </em><code class="descclassname">posblock.</code><code class="descname">PosMessage</code><span class="sig-paren">(</span><em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>PoS Messages are the Transactions
This object represents a single tx/message</p>
<dl class="method">
<dt id="posblock.PosMessage.add_to_proto">
<code class="descname">add_to_proto</code><span class="sig-paren">(</span><em>protocmd</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.add_to_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the tx into the given protobuf command (not in a block).</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>protocmd</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.add_to_proto_block">
<code class="descname">add_to_proto_block</code><span class="sig-paren">(</span><em>protoblock</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.add_to_proto_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds the tx into the given block.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>protoblock</strong> &#8211; a block value of a proto command</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.check">
<code class="descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Validity check when a node receives a tx.
Raise on error</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.from_dict">
<code class="descname">from_dict</code><span class="sig-paren">(</span><em>tx_dict</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.from_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a dict representing a message to the native object format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tx_dict</strong> &#8211; a python dict()</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a PosMessage instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.from_list">
<code class="descname">from_list</code><span class="sig-paren">(</span><em>tx_list</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.from_list" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from list to object format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tx_list</strong> &#8211; list()</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a PosMessage instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.from_proto">
<code class="descname">from_proto</code><span class="sig-paren">(</span><em>proto_tx</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.from_proto" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert from protobuf to object format.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>proto_tx</strong> &#8211; a protobuf object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a PosMessage instance</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.from_values">
<code class="descname">from_values</code><span class="sig-paren">(</span><em>timestamp=0</em>, <em>sender=''</em>, <em>recipient=''</em>, <em>what=0</em>, <em>params=''</em>, <em>value=0</em>, <em>pubkey=None</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.from_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Manually creates the transaction object from user values</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>timestamp</strong> &#8211; </li>
<li><strong>sender</strong> &#8211; </li>
<li><strong>recipient</strong> &#8211; </li>
<li><strong>what</strong> &#8211; </li>
<li><strong>params</strong> &#8211; </li>
<li><strong>value</strong> &#8211; </li>
<li><strong>pubkey</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">the PosMessage instance</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="posblock.PosMessage.hex_encodable">
<code class="descname">hex_encodable</code><em class="property"> = ('txid', 'pubkey')</em><a class="headerlink" href="#posblock.PosMessage.hex_encodable" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="posblock.PosMessage.props">
<code class="descname">props</code><em class="property"> = ('txid', 'block_height', 'timestamp', 'sender', 'recipient', 'what', 'params', 'value', 'pubkey', 'received')</em><a class="headerlink" href="#posblock.PosMessage.props" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.sign">
<code class="descname">sign</code><span class="sig-paren">(</span><em>verify=True</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign the raw tx. Uses keys from poscrypto module.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>verify</strong> &#8211; Should we verify the tx? Defaults to True</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Signature as bytearray.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.to_db">
<code class="descname">to_db</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.to_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Tuple representation of the PosMessage instance for db insert. In the db order, with  received as last extra field.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.to_json">
<code class="descname">to_json</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.to_json" title="Permalink to this definition">¶</a></dt>
<dd><p>Json readable version of the PosMessage instance content,
with <em>binary content as hex encoded string</em>.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.to_list">
<code class="descname">to_list</code><span class="sig-paren">(</span><em>as_hex=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.to_list" title="Permalink to this definition">¶</a></dt>
<dd><p>List representation of the PosMessage instance.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.to_raw">
<code class="descname">to_raw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.to_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Raw representation of the PosMessage instance, signed parts only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Bytes, a raw buffer</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posblock.PosMessage.to_str_list">
<code class="descname">to_str_list</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posblock.PosMessage.to_str_list" title="Permalink to this definition">¶</a></dt>
<dd><p>list of str so we can concat for batch db insert</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list of string</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="posmempool-pos-mempool-abstraction-class">
<h1>posmempool - PoS mempool abstraction class<a class="headerlink" href="#posmempool-pos-mempool-abstraction-class" title="Permalink to this headline">¶</a></h1>
<p>An abstraction class used by poshn.</p>
<span class="target" id="module-posmempool"></span><p>A Safe thread object interfacing the PoS mempool.</p>
<p>FR: Dump mempool to disk when closing, and re-import/filter out on load so we don&#8217;t loose potentially important
messages when things go wrong and everyone crashes.</p>
<p>See <a class="reference external" href="https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.backup">https://docs.python.org/3/library/sqlite3.html#sqlite3.Connection.backup</a>
or <a class="reference external" href="https://github.com/husio/python-sqlite3-backup">https://github.com/husio/python-sqlite3-backup</a></p>
<dl class="class">
<dt id="posmempool.MemoryMempool">
<em class="property">class </em><code class="descclassname">posmempool.</code><code class="descname">MemoryMempool</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>app_log=None</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.MemoryMempool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#posmempool.Mempool" title="posmempool.Mempool"><code class="xref py py-class docutils literal"><span class="pre">posmempool.Mempool</span></code></a></p>
<p>Memory Storage, POC only - Deprecated</p>
<dl class="method">
<dt id="posmempool.MemoryMempool._delete_tx">
<code class="descname">_delete_tx</code><span class="sig-paren">(</span><em>tx</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.MemoryMempool._delete_tx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posmempool.MemoryMempool._insert_tx">
<code class="descname">_insert_tx</code><span class="sig-paren">(</span><em>tx</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.MemoryMempool._insert_tx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posmempool.MemoryMempool.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.MemoryMempool.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="posmempool.Mempool">
<em class="property">class </em><code class="descclassname">posmempool.</code><code class="descname">Mempool</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>app_log=None</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Generic Parent Class</p>
<dl class="method">
<dt id="posmempool.Mempool._delete_tx">
<code class="descname">_delete_tx</code><span class="sig-paren">(</span><em>tx</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool._delete_tx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posmempool.Mempool._insert_tx">
<code class="descname">_insert_tx</code><span class="sig-paren">(</span><em>tx</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool._insert_tx" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posmempool.Mempool.async_all">
<code class="descname">async_all</code><span class="sig-paren">(</span><em>block_height=0</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool.async_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all tx to embed in current block</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.Mempool.digest_tx">
<code class="descname">digest_tx</code><span class="sig-paren">(</span><em>tx</em>, <em>poschain=None</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool.digest_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Check validity of the transaction and insert if mempool if ok.
TODO: 2 steps when getting batch: first checks, then a single insert
FR: We could also keep just the txids in a ram dict to filter out faster. (no need if ram mempool)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tx</strong> &#8211; </li>
<li><strong>poschain</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.Mempool.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posmempool.Mempool.tx_count">
<code class="descname">tx_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool.tx_count" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="posmempool.Mempool.tx_exists">
<code class="descname">tx_exists</code><span class="sig-paren">(</span><em>txid</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.Mempool.tx_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell is the given txid is in our mempool already.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="posmempool.SqliteMempool">
<em class="property">class </em><code class="descclassname">posmempool.</code><code class="descname">SqliteMempool</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>db_path='./data/'</em>, <em>app_log=None</em>, <em>ram=False</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#posmempool.Mempool" title="posmempool.Mempool"><code class="xref py py-class docutils literal"><span class="pre">posmempool.Mempool</span></code></a>, <a class="reference internal" href="#sqlitebase.SqliteBase" title="sqlitebase.SqliteBase"><code class="xref py py-class docutils literal"><span class="pre">sqlitebase.SqliteBase</span></code></a></p>
<p>Sqlite storage backend.</p>
<dl class="method">
<dt id="posmempool.SqliteMempool._insert_tx">
<code class="descname">_insert_tx</code><span class="sig-paren">(</span><em>tx</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool._insert_tx" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Save to tx (=PosMessage) object in db</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>tx</strong> &#8211; a notive PosMessage object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_all">
<code class="descname">async_all</code><span class="sig-paren">(</span><em>block_height=0</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all transactions in current mempool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list() of PosMessages instances</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_alltxids">
<code class="descname">async_alltxids</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_alltxids" title="Permalink to this definition">¶</a></dt>
<dd><p>Return all txids from mempool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">list()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_del_hex_txids">
<code class="descname">async_del_hex_txids</code><span class="sig-paren">(</span><em>hex_txids</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_del_hex_txids" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a list of the txs from mempool. Optimized, more than 100x executemany()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_txids</strong> &#8211; list of &#8220;X&#8217;hex_encoded_string&#8217;&#8221; strings for sqlite.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_del_txids">
<code class="descname">async_del_txids</code><span class="sig-paren">(</span><em>txids</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_del_txids" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a list of the txs from mempool. Optimized, more than 100x executemany()</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>txids</strong> &#8211; binary txid (bytes)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_del_txids_old">
<code class="descname">async_del_txids_old</code><span class="sig-paren">(</span><em>txids</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_del_txids_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a list of the txs from mempool. Older and slower version, kept for temp. reference.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>txids</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">True</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_purge">
<code class="descname">async_purge</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_purge" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Purge old txs</p>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_purge_start">
<code class="descname">async_purge_start</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_purge_start" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Purge our old start messages if they are too numerous or too old</p>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.async_since">
<code class="descname">async_since</code><span class="sig-paren">(</span><em>date=0</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.async_since" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Return the list of transactions we got since the given date</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>date</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">a list of posblock.PosMessage objects</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.check">
<code class="descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Check and creates mempool. This is not async yet, so we close afterward.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.clear">
<code class="descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Empty mempool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Return mempool status.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">status as dict()</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.tx_count">
<code class="descname">tx_count</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.tx_count" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Mempool current transactions count.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">int</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="posmempool.SqliteMempool.tx_exists">
<code class="descname">tx_exists</code><span class="sig-paren">(</span><em>txid</em><span class="sig-paren">)</span><a class="headerlink" href="#posmempool.SqliteMempool.tx_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell is the given txid is in our mempool.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">Boolean</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="sqlitebase-sqlite3-backend-abstraction-class">
<h1>sqlitebase - Sqlite3 backend abstraction class<a class="headerlink" href="#sqlitebase-sqlite3-backend-abstraction-class" title="Permalink to this headline">¶</a></h1>
<p>An abstraction class used by posmempool and poschain.</p>
<span class="target" id="module-sqlitebase"></span><p>A common ancestor for sqlite related storage objects.</p>
<p>Used by mempool and poschain</p>
<dl class="class">
<dt id="sqlitebase.SqliteBase">
<em class="property">class </em><code class="descclassname">sqlitebase.</code><code class="descname">SqliteBase</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>db_path: str = './data/'</em>, <em>db_name: str = 'posmempool.db'</em>, <em>app_log: &lt;function log at 0x7fcf14e2c598&gt; = None</em>, <em>ram: str = False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Generic Sqlite storage backend.</p>
<dl class="method">
<dt id="sqlitebase.SqliteBase.async_close">
<code class="descname">async_close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.async_close" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Closes the db handle.</p>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.async_commit">
<code class="descname">async_commit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.async_commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Safe commit</p>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.async_execute">
<code class="descname">async_execute</code><span class="sig-paren">(</span><em>sql: str</em>, <em>param: tuple = None</em>, <em>commit: bool = False</em>, <em>many: bool = False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.async_execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Safely execute the request</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> &#8211; </li>
<li><strong>param</strong> &#8211; </li>
<li><strong>commit</strong> &#8211; If True, will commit after the request.</li>
<li><strong>many</strong> &#8211; If True, will use an executemany call with param being a list of params.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a cursor async proxy, or None if commit. If not commit, cursor() has to be closed.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.async_fetchall">
<code class="descname">async_fetchall</code><span class="sig-paren">(</span><em>sql: str</em>, <em>param: tuple = None</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.async_fetchall" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Fetch all and Returns data</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> &#8211; </li>
<li><strong>param</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.async_fetchone">
<code class="descname">async_fetchone</code><span class="sig-paren">(</span><em>sql: str</em>, <em>param: tuple = None</em>, <em>as_dict: bool = False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.async_fetchone" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Fetch one and Returns data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> &#8211; </li>
<li><strong>param</strong> &#8211; </li>
<li><strong>as_dict</strong> &#8211; returns result as a dict, default False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple()</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.async_vacuum">
<code class="descname">async_vacuum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.async_vacuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Async. Maintenance (Vacuum)</p>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.check">
<code class="descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks and creates db. This is not async yet, so we close afterward.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.close">
<code class="descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Closes the db handle.</p>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.commit">
<code class="descname">commit</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.commit" title="Permalink to this definition">¶</a></dt>
<dd><p>Safe commit</p>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.execute">
<code class="descname">execute</code><span class="sig-paren">(</span><em>sql: str</em>, <em>param: tuple = None</em>, <em>cursor=None</em>, <em>commit: bool = False</em>, <em>many: bool = False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.execute" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely execute the request</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> &#8211; </li>
<li><strong>param</strong> &#8211; </li>
<li><strong>cursor</strong> &#8211; optional. will use the locked shared cursor if None</li>
<li><strong>commit</strong> &#8211; optional. will commit after sql</li>
<li><strong>many</strong> &#8211; If True, will use an executemany call with param being a list of params.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">cursor</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="sqlitebase.SqliteBase.fetchone">
<code class="descname">fetchone</code><span class="sig-paren">(</span><em>sql: str</em>, <em>param: tuple = None</em>, <em>as_dict: bool = False</em><span class="sig-paren">)</span><a class="headerlink" href="#sqlitebase.SqliteBase.fetchone" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch one and Returns data.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>sql</strong> &#8211; </li>
<li><strong>param</strong> &#8211; </li>
<li><strong>as_dict</strong> &#8211; returns result as a dict, default False.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">tuple()</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="poscrypto-pos-crypto-primitives-helpers">
<h1>poscrypto - PoS crypto primitives helpers<a class="headerlink" href="#poscrypto-pos-crypto-primitives-helpers" title="Permalink to this headline">¶</a></h1>
<p>Low level crypto utils.</p>
<span class="target" id="module-poscrypto"></span><div class="section" id="pos-related-crypto-helpers">
<h2>PoS related crypto helpers<a class="headerlink" href="#pos-related-crypto-helpers" title="Permalink to this headline">¶</a></h2>
<p>Low level cryptographic functions for Bismuth Hypernodes.</p>
<dl class="function">
<dt id="poscrypto.blake">
<code class="descclassname">poscrypto.</code><code class="descname">blake</code><span class="sig-paren">(</span><em>buffer</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.blake" title="Permalink to this definition">¶</a></dt>
<dd><p>Blake hash of a raw buffer or string/</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>buffer</strong> &#8211; str or bytes</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">binary hash</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.check_sig">
<code class="descclassname">poscrypto.</code><code class="descname">check_sig</code><span class="sig-paren">(</span><em>signature</em>, <em>pubkey_string</em>, <em>message</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.check_sig" title="Permalink to this definition">¶</a></dt>
<dd><p>Raise ValueError if the signature of message does not match pubkey</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>signature</strong> &#8211; </li>
<li><strong>pubkey_string</strong> &#8211; the pubkey, string version.</li>
<li><strong>message</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.gen_keys">
<code class="descclassname">poscrypto.</code><code class="descname">gen_keys</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.gen_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a new set of keys.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">tuple (priv, pub, address), all as string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.gen_keys_file">
<code class="descclassname">poscrypto.</code><code class="descname">gen_keys_file</code><span class="sig-paren">(</span><em>pos_filename='poswallet.json'</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.gen_keys_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Generates a new set of keys and saves to json wallet</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>pos_filename</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">the generated wallet as a dict</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.hash_to_addr">
<code class="descclassname">poscrypto.</code><code class="descname">hash_to_addr</code><span class="sig-paren">(</span><em>hash20</em>, <em>network=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.hash_to_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a hash of len 20 bytes to a checksum&#8217;d + network id address, to compare to an address</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>hash20</strong> &#8211; bytes</li>
<li><strong>network</strong> &#8211; byte</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.hex_to_raw">
<code class="descclassname">poscrypto.</code><code class="descname">hex_to_raw</code><span class="sig-paren">(</span><em>hex_str</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.hex_to_raw" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert an hex string into a byte string. The Hex Byte values may
or may not be space separated.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hex_str</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">bytes</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.load_keys">
<code class="descclassname">poscrypto.</code><code class="descname">load_keys</code><span class="sig-paren">(</span><em>pos_filename='poswallet.json'</em>, <em>verbose=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.load_keys" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the keys from wallet json file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pos_filename</strong> &#8211; </li>
<li><strong>verbose</strong> &#8211; boolean, print out address and pubkey</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">True or raise.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.pub_key_to_addr">
<code class="descclassname">poscrypto.</code><code class="descname">pub_key_to_addr</code><span class="sig-paren">(</span><em>pub_key</em>, <em>network=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.pub_key_to_addr" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a public key to a checksum&#8217;d + network id address</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>pub_key</strong> &#8211; </li>
<li><strong>network</strong> &#8211; byte</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">string</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.raw_to_hex">
<code class="descclassname">poscrypto.</code><code class="descname">raw_to_hex</code><span class="sig-paren">(</span><em>digest</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.raw_to_hex" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the <strong>printable</strong> hex digest of a byte buffer.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">The hash digest, Hexadecimal encoded.</td>
</tr>
<tr class="field-even field"><th class="field-name">Return type:</th><td class="field-body">string</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.sign">
<code class="descclassname">poscrypto.</code><code class="descname">sign</code><span class="sig-paren">(</span><em>message</em>, <em>verify=True</em>, <em>priv_key=None</em>, <em>pub_key=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.sign" title="Permalink to this definition">¶</a></dt>
<dd><p>Sign a message with the default keys and return its signature.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>message</strong> &#8211; A string or byte object</li>
<li><strong>verify</strong> &#8211; Shall we verify the signature? default to True</li>
<li><strong>priv_key</strong> &#8211; opt</li>
<li><strong>pub_key</strong> &#8211; opt</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">bytes (signature)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poscrypto.validate_address">
<code class="descclassname">poscrypto.</code><code class="descname">validate_address</code><span class="sig-paren">(</span><em>address</em>, <em>network=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poscrypto.validate_address" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode and verify the checksum of a Base58 encoded string.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>address</strong> &#8211; the address string to validate</li>
<li><strong>network</strong> &#8211; The network id to validate against</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The 20 bytes hash of the pubkey if address matches format and network, or throw an exception</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="posclient-client-hypernode-class">
<h1>posclient - Client hypernode class<a class="headerlink" href="#posclient-client-hypernode-class" title="Permalink to this headline">¶</a></h1>
<p>WIP - A self contained client class for APIs or client line tools.</p>
<span class="target" id="module-posclient"></span><div class="section" id="pos-client-class-for-bismuth-hypernodes">
<h2>Pos client class for Bismuth HyperNodes<a class="headerlink" href="#pos-client-class-for-bismuth-hypernodes" title="Permalink to this headline">¶</a></h2>
<p>Tornado based</p>
<dl class="class">
<dt id="posclient.Posclient">
<em class="property">class </em><code class="descclassname">posclient.</code><code class="descname">Posclient</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>verbose=False</em>, <em>wallet='poswallet.json'</em>, <em>version=''</em><span class="sig-paren">)</span><a class="headerlink" href="#posclient.Posclient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="posclient.Posclient.action">
<code class="descname">action</code><span class="sig-paren">(</span><em>action='hello'</em>, <em>param=''</em><span class="sig-paren">)</span><a class="headerlink" href="#posclient.Posclient.action" title="Permalink to this definition">¶</a></dt>
<dd><p>Action Handler</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>action</strong> &#8211; </li>
<li><strong>param</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The command result</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="determine-pseudo-determinist-helpers">
<h1>determine - Pseudo determinist helpers<a class="headerlink" href="#determine-pseudo-determinist-helpers" title="Permalink to this headline">¶</a></h1>
<p>Helpers to sort tickers, peers, determine slots and such.</p>
<span class="target" id="module-determine"></span><p>Deterministic helpers and/or classes for Bismuth PoS</p>
<dl class="data">
<dt id="determine.REF_HASH">
<code class="descclassname">determine.</code><code class="descname">REF_HASH</code><em class="property"> = b''</em><a class="headerlink" href="#determine.REF_HASH" title="Permalink to this definition">¶</a></dt>
<dd><p>Warning : &#8220;Note that even for small len(x), the total number of permutations of x can quickly grow larger than the
period of most random number generators.
This implies that most permutations of a long sequence can never be generated. For example, a sequence of length 2080 is
the largest that can fit within the period of the Mersenne Twister random number generator.&#8221;</p>
</dd></dl>

<dl class="function">
<dt id="determine.connect_ok_from">
<code class="descclassname">determine.</code><code class="descname">connect_ok_from</code><span class="sig-paren">(</span><em>msg</em>, <em>access_log</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.connect_ok_from" title="Permalink to this definition">¶</a></dt>
<dd><p>TODO - Checks if the peer can connect to us</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>msg</strong> &#8211; </li>
<li><strong>access_log</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">reason (string), ok (boolean)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.get_connect_to">
<code class="descclassname">determine.</code><code class="descname">get_connect_to</code><span class="sig-paren">(</span><em>peers</em>, <em>pos_round</em>, <em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.get_connect_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends back the list of peers to connect to</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>peers</strong> &#8211; </li>
<li><strong>pos_round</strong> &#8211; </li>
<li><strong>address</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.hn_list_to_test_slots">
<code class="descclassname">determine.</code><code class="descname">hn_list_to_test_slots</code><span class="sig-paren">(</span><em>full_hn_list</em>, <em>forge_slots</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.hn_list_to_test_slots" title="Permalink to this definition">¶</a></dt>
<dd><p>Predict tests to be run during each slot, but avoid testing forging HN</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>full_hn_list</strong> &#8211; </li>
<li><strong>forge_slots</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list with list of tests for each slot.</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.hn_list_to_tickets">
<code class="descclassname">determine.</code><code class="descname">hn_list_to_tickets</code><span class="sig-paren">(</span><em>hn_list</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.hn_list_to_tickets" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>hn_list</strong> &#8211; list of hn with properties</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">list of tickets for jurors determination</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.my_distance">
<code class="descclassname">determine.</code><code class="descname">my_distance</code><span class="sig-paren">(</span><em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.my_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>DEPRECATED - Return the Hamming distance between an address and the ref hash, that was converted to be address like</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>address</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.my_hash_distance">
<code class="descclassname">determine.</code><code class="descname">my_hash_distance</code><span class="sig-paren">(</span><em>peer</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.my_hash_distance" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the Hamming distance between a hash and the ref hash</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>peer</strong> &#8211; tuple(addr, ticket id, hash)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.pick_two_not_in">
<code class="descclassname">determine.</code><code class="descname">pick_two_not_in</code><span class="sig-paren">(</span><em>address_list</em>, <em>avoid</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.pick_two_not_in" title="Permalink to this definition">¶</a></dt>
<dd><p>Pick a random couple of hn not in avoid</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>address_list</strong> &#8211; </li>
<li><strong>avoid</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.tickets_to_jurors">
<code class="descclassname">determine.</code><code class="descname">tickets_to_jurors</code><span class="sig-paren">(</span><em>tickets_list</em>, <em>reference_hash</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.tickets_to_jurors" title="Permalink to this definition">¶</a></dt>
<dd><p>Order and extract only the required number of candidates from the tickets</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>tickets_list</strong> &#8211; </li>
<li><strong>reference_hash</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="determine.timestamp_to_round_slot">
<code class="descclassname">determine.</code><code class="descname">timestamp_to_round_slot</code><span class="sig-paren">(</span><em>ts=0</em><span class="sig-paren">)</span><a class="headerlink" href="#determine.timestamp_to_round_slot" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a timestamp, returns the specific round and slot# that fits.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>ts</strong> &#8211; timestamp to use. If 0, will use current time</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">tuple (round, slot in round)</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-com_helpers">
<span id="com-helpers-util-module"></span><h1>com_helpers - Util module<a class="headerlink" href="#module-com_helpers" title="Permalink to this headline">¶</a></h1>
<div class="section" id="communication-helper-utils-for-bismuth-hypernodes">
<h2>Communication helper utils for Bismuth Hypernodes<a class="headerlink" href="#communication-helper-utils-for-bismuth-hypernodes" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="com_helpers.async_receive">
<code class="descclassname">com_helpers.</code><code class="descname">async_receive</code><span class="sig-paren">(</span><em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_receive" title="Permalink to this definition">¶</a></dt>
<dd><p>Get a command block from the stream, async version</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a protobuf object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send">
<code class="descclassname">com_helpers.</code><code class="descname">async_send</code><span class="sig-paren">(</span><em>cmd</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a protobuf command with data to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmd</strong> &#8211; a protobuf object</li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send_block">
<code class="descclassname">com_helpers.</code><code class="descname">async_send_block</code><span class="sig-paren">(</span><em>proto_block</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a block to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proto_block</strong> &#8211; a full protobuf command with a block</li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send_height">
<code class="descclassname">com_helpers.</code><code class="descname">async_send_height</code><span class="sig-paren">(</span><em>cmd</em>, <em>height</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a height status to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmd</strong> &#8211; the protobuff command</li>
<li><strong>height</strong> &#8211; a PosHeight object</li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send_int32">
<code class="descclassname">com_helpers.</code><code class="descname">async_send_int32</code><span class="sig-paren">(</span><em>cmd</em>, <em>value</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send_int32" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a command with int32 param to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmd</strong> &#8211; the protobuff command</li>
<li><strong>value</strong> &#8211; </li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send_string">
<code class="descclassname">com_helpers.</code><code class="descname">async_send_string</code><span class="sig-paren">(</span><em>cmd</em>, <em>value</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a command with string param to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmd</strong> &#8211; the protobuff command</li>
<li><strong>value</strong> &#8211; </li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send_txs">
<code class="descclassname">com_helpers.</code><code class="descname">async_send_txs</code><span class="sig-paren">(</span><em>cmd</em>, <em>txs</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send_txs" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a list of tx to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmd</strong> &#8211; the protobuff command</li>
<li><strong>txs</strong> &#8211; a list of tx</li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.async_send_void">
<code class="descclassname">com_helpers.</code><code class="descname">async_send_void</code><span class="sig-paren">(</span><em>cmd</em>, <em>stream</em>, <em>ip</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.async_send_void" title="Permalink to this definition">¶</a></dt>
<dd><p>Sends a command to the stream, async.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>cmd</strong> &#8211; the protobuff command</li>
<li><strong>stream</strong> &#8211; </li>
<li><strong>ip</strong> &#8211; the related ip, for stats purposes</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">none</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="com_helpers.cmd_to_text">
<code class="descclassname">com_helpers.</code><code class="descname">cmd_to_text</code><span class="sig-paren">(</span><em>command</em><span class="sig-paren">)</span><a class="headerlink" href="#com_helpers.cmd_to_text" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts a protobuf Command id to a text</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>command</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
</div>
<div class="section" id="module-base58">
<span id="base58-util-module"></span><h1>base58 - Util module<a class="headerlink" href="#module-base58" title="Permalink to this headline">¶</a></h1>
<p>Bismuth
Base58 encoding, decoding, checksum of PoS addresses</p>
<p>Adapted from various public domain sources</p>
<dl class="function">
<dt id="base58.b58decode">
<code class="descclassname">base58.</code><code class="descname">b58decode</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode a Base58 encoded string and returns a byte object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.b58decode_int">
<code class="descclassname">base58.</code><code class="descname">b58decode_int</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58decode_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode a Base58 encoded string as an integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.b58encode">
<code class="descclassname">base58.</code><code class="descname">b58encode</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode a string or byte object using Base58</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.b58encode_int">
<code class="descclassname">base58.</code><code class="descname">b58encode_int</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58encode_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode an integer using Base58</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.buffer">
<code class="descclassname">base58.</code><code class="descname">buffer</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.buffer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="base58.iseq">
<code class="descclassname">base58.</code><code class="descname">iseq</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.iseq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="base58.scrub_input">
<code class="descclassname">base58.</code><code class="descname">scrub_input</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.scrub_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts string to byte object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-poshelpers">
<span id="poshelpers-util-module"></span><h1>poshelpers - Util module<a class="headerlink" href="#module-poshelpers" title="Permalink to this headline">¶</a></h1>
<p>Bismuth
Common helpers for PoS</p>
<dl class="function">
<dt id="poshelpers.bool_to_dbstr">
<code class="descclassname">poshelpers.</code><code class="descname">bool_to_dbstr</code><span class="sig-paren">(</span><em>a_bool: bool</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.bool_to_dbstr" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="poshelpers.download_file">
<code class="descclassname">poshelpers.</code><code class="descname">download_file</code><span class="sig-paren">(</span><em>url: str</em>, <em>filename: str</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.download_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch a file from an URL with progress indicator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>url</strong> &#8211; </li>
<li><strong>filename</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.fake_hn_dict">
<code class="descclassname">poshelpers.</code><code class="descname">fake_hn_dict</code><span class="sig-paren">(</span><em>inactive_last_round</em>, <em>app_log</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.fake_hn_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Simulates getting HN info from the Pow, but takes from the hn_temp instead. DEV/Debug only</p>
<p>Do NOT use in prod ever.</p>
<p>Indexed by bis_addr, sub dict keys: [&#8216;ip&#8217;, &#8216;port&#8217;, &#8216;pos&#8217;, &#8216;reward&#8217;, &#8216;weight&#8217;, &#8216;timestamp&#8217;, &#8216;active&#8217;]</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">dict of dict.</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.first_height_is_better">
<code class="descclassname">poshelpers.</code><code class="descname">first_height_is_better</code><span class="sig-paren">(</span><em>height_a: dict</em>, <em>height_b: dict</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.first_height_is_better" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares properties of the heights to tell which one is to keep in case of forks.
Uses &#8216;forgers&#8217;, &#8216;forgers_round&#8217;, &#8216;uniques&#8217;, &#8216;uniques_round&#8217;, &#8216;round&#8217;, &#8216;height&#8217;</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>height_a</strong> &#8211; </li>
<li><strong>height_b</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean, True if a is &gt; b</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.heights_match">
<code class="descclassname">poshelpers.</code><code class="descname">heights_match</code><span class="sig-paren">(</span><em>height_a: dict</em>, <em>height_b: dict</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.heights_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if simulated height_b fits the predicate height_a
only checks the current round info, not the whole chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>height_a</strong> &#8211; a height dict</li>
<li><strong>height_b</strong> &#8211; a height dict</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.hello_string">
<code class="descclassname">poshelpers.</code><code class="descname">hello_string</code><span class="sig-paren">(</span><em>port: int = 101</em>, <em>posnet: str = None</em>, <em>address: str = None</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.hello_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Build hello string from params.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>port</strong> &#8211; port number</li>
<li><strong>posnet</strong> &#8211; posnet version</li>
<li><strong>address</strong> &#8211; pos address</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.hello_to_params">
<code class="descclassname">poshelpers.</code><code class="descname">hello_to_params</code><span class="sig-paren">(</span><em>hello: str</em>, <em>as_dict=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.hello_to_params" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="poshelpers.ipport_to_fullpeer">
<code class="descclassname">poshelpers.</code><code class="descname">ipport_to_fullpeer</code><span class="sig-paren">(</span><em>ip: str</em>, <em>port: int</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.ipport_to_fullpeer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="poshelpers.load_hn_temp">
<code class="descclassname">poshelpers.</code><code class="descname">load_hn_temp</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.load_hn_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>fill list of HNs from our local repo, for dev at scale.</p>
<p>Do NOT use in prod ever.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.peer_to_fullpeer">
<code class="descclassname">poshelpers.</code><code class="descname">peer_to_fullpeer</code><span class="sig-paren">(</span><em>peer: tuple</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.peer_to_fullpeer" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a tuple (address, ip, port, active) to a string ip:0port</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>peer</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.same_height">
<code class="descclassname">poshelpers.</code><code class="descname">same_height</code><span class="sig-paren">(</span><em>peer_status: dict</em>, <em>our_status: dict</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.same_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares not only the height but the whole properties, including Round, Slot In Round and block hash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>peer_status</strong> &#8211; </li>
<li><strong>our_status</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="poshelpers.update_source">
<code class="descclassname">poshelpers.</code><code class="descname">update_source</code><span class="sig-paren">(</span><em>url: str</em>, <em>app_log: &lt;function log at 0x7fcf14e2c598&gt; = None</em><span class="sig-paren">)</span><a class="headerlink" href="#poshelpers.update_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Update source file from an url</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>url</strong> &#8211; url of the tgz archive</li>
<li><strong>app_log</strong> &#8211; optional log handler</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">&gt; Modules</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#module-config">config - Constants and settings</a></li>
<li class="toctree-l1"><a class="reference internal" href="#poshn-core-hypernode-class">poshn - core hypernode class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#poschain-pos-chain-abstraction-class">poschain - PoS chain abstraction class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#posblock-pos-block-abstraction-class">posblock - PoS block abstraction class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#posmempool-pos-mempool-abstraction-class">posmempool - PoS mempool abstraction class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#sqlitebase-sqlite3-backend-abstraction-class">sqlitebase - Sqlite3 backend abstraction class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#poscrypto-pos-crypto-primitives-helpers">poscrypto - PoS crypto primitives helpers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pos-related-crypto-helpers">PoS related crypto helpers</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#posclient-client-hypernode-class">posclient - Client hypernode class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pos-client-class-for-bismuth-hypernodes">Pos client class for Bismuth HyperNodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#determine-pseudo-determinist-helpers">determine - Pseudo determinist helpers</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-com_helpers">com_helpers - Util module</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#communication-helper-utils-for-bismuth-hypernodes">Communication helper utils for Bismuth Hypernodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#module-base58">base58 - Util module</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-poshelpers">poshelpers - Util module</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypernode.html">&gt; Bismuth Hypernodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypernode.html#module-hn_instance">hn_instance: HyperNode instance</a></li>
<li class="toctree-l1"><a class="reference internal" href="hypernode.html#module-hn_client">hn_client: HyperNode Client</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Bismuth Hypernodes&#8217;s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="hypernode.html"
                        title="next chapter">&gt; Bismuth Hypernodes</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="hypernode.html" title="&gt; Bismuth Hypernodes"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Bismuth Hypernodes’s documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bismuth Hypernodes 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Bismuth Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.6.
    </div>
  </body>
</html>