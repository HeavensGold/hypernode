
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>&gt; Modules &#8212; Bismuth Hypernodes 0.1 documentation</title>
    <link rel="stylesheet" href="_static/classic.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="&gt; Bismuth Hypernodes" href="poc.html" />
    <link rel="prev" title="Welcome to Bismuth Hypernodes’s documentation!" href="index.html" /> 
  </head><body>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="poc.html" title="&gt; Bismuth Hypernodes"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Bismuth Hypernodes’s documentation!"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bismuth Hypernodes 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="modules">
<h1>&gt; Modules<a class="headerlink" href="#modules" title="Permalink to this headline">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
</div>
<div class="section" id="poshn-core-hypernode-class">
<h1>poshn - core hypernode class<a class="headerlink" href="#poshn-core-hypernode-class" title="Permalink to this headline">¶</a></h1>
<p>The Core Hypernode server class</p>
<span class="target" id="module-poshn"></span><p>Pos Hypernode class for Bismuth Cryptocurrency
Tornado based</p>
<dl class="docutils">
<dt>Note:</dt>
<dd>TODO: are prioritary actions TBD
FR: are features request. Think of them as second class
TODO items that are less urgent
FR: will go into TODO: as TODO: is cleared.</dd>
</dl>
<dl class="class">
<dt id="poshn.HNState">
<em class="property">class </em><code class="descclassname">poshn.</code><code class="descname">HNState</code><a class="headerlink" href="#poshn.HNState" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">enum.Enum</span></code></p>
<p>Current State of the HN</p>
<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_CONNECT1">
<code class="descname">CATCHING_UP_CONNECT1</code><em class="property"> = 7</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_CONNECT1" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_CONNECT2">
<code class="descname">CATCHING_UP_CONNECT2</code><em class="property"> = 8</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_CONNECT2" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_ELECT">
<code class="descname">CATCHING_UP_ELECT</code><em class="property"> = 9</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_ELECT" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_PRESYNC">
<code class="descname">CATCHING_UP_PRESYNC</code><em class="property"> = 10</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_PRESYNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.CATCHING_UP_SYNC">
<code class="descname">CATCHING_UP_SYNC</code><em class="property"> = 11</em><a class="headerlink" href="#poshn.HNState.CATCHING_UP_SYNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.FORGING">
<code class="descname">FORGING</code><em class="property"> = 5</em><a class="headerlink" href="#poshn.HNState.FORGING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.MINIMAL_CONSENSUS">
<code class="descname">MINIMAL_CONSENSUS</code><em class="property"> = 4</em><a class="headerlink" href="#poshn.HNState.MINIMAL_CONSENSUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.ROUND_SYNC">
<code class="descname">ROUND_SYNC</code><em class="property"> = 12</em><a class="headerlink" href="#poshn.HNState.ROUND_SYNC" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.SENDING">
<code class="descname">SENDING</code><em class="property"> = 6</em><a class="headerlink" href="#poshn.HNState.SENDING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.START">
<code class="descname">START</code><em class="property"> = 0</em><a class="headerlink" href="#poshn.HNState.START" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.STRONG_CONSENSUS">
<code class="descname">STRONG_CONSENSUS</code><em class="property"> = 3</em><a class="headerlink" href="#poshn.HNState.STRONG_CONSENSUS" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.SYNCING">
<code class="descname">SYNCING</code><em class="property"> = 1</em><a class="headerlink" href="#poshn.HNState.SYNCING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="poshn.HNState.TESTING">
<code class="descname">TESTING</code><em class="property"> = 2</em><a class="headerlink" href="#poshn.HNState.TESTING" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="poshn.HnServer">
<em class="property">class </em><code class="descclassname">poshn.</code><code class="descname">HnServer</code><a class="headerlink" href="#poshn.HnServer" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">tornado.tcpserver.TCPServer</span></code></p>
<p>Tornado asynchronous TCP server.</p>
<dl class="method">
<dt id="poshn.HnServer._handle_msg">
<code class="descname">_handle_msg</code><span class="sig-paren">(</span><em>msg</em>, <em>stream</em>, <em>peer_ip</em>, <em>peer_port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HnServer._handle_msg" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles a single command received by the server.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>msg</strong> – </li>
<li><strong>stream</strong> – </li>
<li><strong>peer_ip</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.HnServer.handle_stream">
<code class="descname">handle_stream</code><span class="sig-paren">(</span><em>stream</em>, <em>address</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HnServer.handle_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Handles the lifespan of a client, from connection to end of stream</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>stream</strong> – </li>
<li><strong>address</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.HnServer.update">
<code class="descname">update</code><span class="sig-paren">(</span><em>url</em>, <em>stream</em>, <em>peer_ip</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.HnServer.update" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="data">
<dt id="poshn.MINIMUM_CONNECTIVITY">
<code class="descclassname">poshn.</code><code class="descname">MINIMUM_CONNECTIVITY</code><em class="property"> = 2</em><a class="headerlink" href="#poshn.MINIMUM_CONNECTIVITY" title="Permalink to this definition">¶</a></dt>
<dd><p>TCP Server Classe</p>
</dd></dl>

<dl class="class">
<dt id="poshn.Poshn">
<em class="property">class </em><code class="descclassname">poshn.</code><code class="descname">Poshn</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>address=''</em>, <em>peers=None</em>, <em>verbose=False</em>, <em>wallet='poswallet.json'</em>, <em>datadir='data'</em>, <em>suffix=''</em>, <em>version=''</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>The PoS Hypernode object</p>
<dl class="method">
<dt id="poshn.Poshn._check_round">
<code class="descname">_check_round</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._check_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust round/slots depending properties.
Always called from the manager co-routine only.
Should not be called too often (1-10sec should be plenty)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._consensus">
<code class="descname">_consensus</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._consensus" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the % of jurors we agree with</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">double</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._exchange_height">
<code class="descname">_exchange_height</code><span class="sig-paren">(</span><em>stream</em>, <em>full_peer</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._exchange_height" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn._exchange_mempool">
<code class="descname">_exchange_mempool</code><span class="sig-paren">(</span><em>stream</em>, <em>full_peer</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._exchange_mempool" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn._get_peer_stream">
<code class="descname">_get_peer_stream</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>temp=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._get_peer_stream" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a stream with communication already established.
stream has to be closed after use.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ip</strong> – 127.0.0.1</li>
<li><strong>port</strong> – 6969</li>
<li><strong>temp</strong> – True - For temps commands, uses a fake 00000 port as self id.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">IOStream</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._get_round_blocks">
<code class="descname">_get_round_blocks</code><span class="sig-paren">(</span><em>peer</em>, <em>a_round</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._get_round_blocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Request full blocks from a full (or partial) round from a given peer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>peer</strong> – </li>
<li><strong>a_round</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">list of blocks</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._round_sync">
<code class="descname">_round_sync</code><span class="sig-paren">(</span><em>a_round</em>, <em>promised_height</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._round_sync" title="Permalink to this definition">¶</a></dt>
<dd><p>Tries to sync from a peer advertising a better chain than ours.
BEWARE: this is only ok if the peer is a juror for the current round.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a_round</strong> – Round # to fetch</li>
<li><strong>promised_height</strong> – dict of the supposedly best available height</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean (success)</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn._update_network">
<code class="descname">_update_network</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn._update_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Adjust peers and network properties.
Always called from the manager co-routine only.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.add_inbound">
<code class="descname">add_inbound</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>properties=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.add_inbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely add a distant peer from server co-routine.
This is called only after initial exchange and approval.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ip</strong> – </li>
<li><strong>port</strong> – </li>
<li><strong>properties</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.change_state_to">
<code class="descname">change_state_to</code><span class="sig-paren">(</span><em>new_state</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.change_state_to" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets new status and logs change.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>new_state</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.client_worker">
<code class="descname">client_worker</code><span class="sig-paren">(</span><em>peer</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.client_worker" title="Permalink to this definition">¶</a></dt>
<dd><p>Client worker, running in a coroutine.
Tries to connect to the given peer, terminates on error and deletes itself on close.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>peer</strong> – (‘aa012345678901aa’, ‘127.0.0.1’, 6969, 1)</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="poshn.Poshn.clients">
<code class="descname">clients</code><em class="property"> = {}</em><a class="headerlink" href="#poshn.Poshn.clients" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.connect">
<code class="descname">connect</code><span class="sig-paren">(</span><em>connect=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Initiate outgoing connections</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.digest_height">
<code class="descname">digest_height</code><span class="sig-paren">(</span><em>height_proto</em>, <em>full_peer</em>, <em>server=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.digest_height" title="Permalink to this definition">¶</a></dt>
<dd><table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>height_proto</strong> – protobuff structure</li>
<li><strong>full_peer</strong> – </li>
<li><strong>server</strong> – comes from the server (inbound) or client (outbound) side?</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.digest_txs">
<code class="descname">digest_txs</code><span class="sig-paren">(</span><em>txs</em>, <em>peer_ip</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.digest_txs" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks tx and digest if they are new
:param txs:
:param peer_ip:
:return:</p>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.forge">
<code class="descname">forge</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.forge" title="Permalink to this definition">¶</a></dt>
<dd><p>Consensus has been reached, we are forger, forge and send block</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.hello_string">
<code class="descname">hello_string</code><span class="sig-paren">(</span><em>temp=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.hello_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds up the hello string</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>temp</strong> – True - For one shot commands, from an already connected ip, uses a fake 00000 port as self id.</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="poshn.Poshn.inbound">
<code class="descname">inbound</code><em class="property"> = {}</em><a class="headerlink" href="#poshn.Poshn.inbound" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.init_check">
<code class="descname">init_check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.init_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Initial coherence check
#&nbsp;FR: more checks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.init_log">
<code class="descname">init_log</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.init_log" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.manager">
<code class="descname">manager</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.manager" title="Permalink to this definition">¶</a></dt>
<dd><p>Manager thread. Responsible for managing inner state of the node.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.post_block">
<code class="descname">post_block</code><span class="sig-paren">(</span><em>proto_block</em>, <em>peer_ip</em>, <em>peer_port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.post_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Co routine to send the block we forged to a given peer
Should we use threads instead and a simpler tcp client? Perfs to be tested.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proto_block</strong> – a protobuf block</li>
<li><strong>peer_ip</strong> – the peer ip</li>
<li><strong>peer_port</strong> – the peer port</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">None</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.refresh_last_block">
<code class="descname">refresh_last_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.refresh_last_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch fresh info from the PoS chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.remove_inbound">
<code class="descname">remove_inbound</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.remove_inbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely remove a distant peer from server co-routine</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ip</strong> – </li>
<li><strong>port</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.serve">
<code class="descname">serve</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.serve" title="Permalink to this definition">¶</a></dt>
<dd><p>Run the socket server.
Once we called that, the calling thread is stopped until the server closes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.status">
<code class="descname">status</code><span class="sig-paren">(</span><em>log=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.status" title="Permalink to this definition">¶</a></dt>
<dd><p>Assemble and store the node status as a dict.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body">HN Status info</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poshn.Poshn.stop">
<code class="descname">stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Signal to stop cleanly</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="poshn.Poshn.stop_event">
<code class="descname">stop_event</code><em class="property"> = &lt;aioprocessing.locks.AioEvent object&gt;</em><a class="headerlink" href="#poshn.Poshn.stop_event" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poshn.Poshn.update_inbound">
<code class="descname">update_inbound</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>properties</em><span class="sig-paren">)</span><a class="headerlink" href="#poshn.Poshn.update_inbound" title="Permalink to this definition">¶</a></dt>
<dd><p>Safely update info for a connected peer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ip</strong> – </li>
<li><strong>port</strong> – </li>
<li><strong>properties</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="poschain-pos-chain-abstraction-class">
<h1>poschain - PoS chain abstraction class<a class="headerlink" href="#poschain-pos-chain-abstraction-class" title="Permalink to this headline">¶</a></h1>
<p>An abstraction class used by poshn</p>
<span class="target" id="module-poschain"></span><p>A Safe thread/process object interfacing the PoS chain</p>
<dl class="class">
<dt id="poschain.MemoryPosChain">
<em class="property">class </em><code class="descclassname">poschain.</code><code class="descname">MemoryPosChain</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>app_log=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.MemoryPosChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#poschain.PosChain" title="poschain.PosChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">poschain.PosChain</span></code></a></p>
<p>Memory Storage, POC only</p>
<dl class="method">
<dt id="poschain.MemoryPosChain.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.MemoryPosChain.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="poschain.PosChain">
<em class="property">class </em><code class="descclassname">poschain.</code><code class="descname">PosChain</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>app_log=None</em>, <em>mempool=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Generic Class</p>
<dl class="method">
<dt id="poschain.PosChain._height_status">
<code class="descname">_height_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain._height_status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poschain.PosChain._invalidate">
<code class="descname">_invalidate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain._invalidate" title="Permalink to this definition">¶</a></dt>
<dd><p>Something changed in our chain, invalidate the status.
It will then be recalc when needed.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain._last_block">
<code class="descname">_last_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain._last_block" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poschain.PosChain.async_blockinfo">
<code class="descname">async_blockinfo</code><span class="sig-paren">(</span><em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.async_blockinfo" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poschain.PosChain.async_height">
<code class="descname">async_height</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.async_height" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a BlockHeight object with our current state</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.check_round">
<code class="descname">check_round</code><span class="sig-paren">(</span><em>a_round</em>, <em>blocks</em>, <em>fast_check=True</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.check_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a round number and all blocks for this round, checks that these blocks are valid candidates.
Does not modify the chain, can be used on existing current round to check validity alternate chains.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>a_round</strong> – </li>
<li><strong>blocks</strong> – a PosBlock object</li>
<li><strong>fast_check</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">a height dict, containing the simulated final state of the chain, or False if blocks are not valid.</p>
</td>
</tr>
</tbody>
</table>
<p><code class="docutils literal notranslate"><span class="pre">{'height':</span> <span class="pre">3631,</span> <span class="pre">'round':</span> <span class="pre">6420,</span> <span class="pre">'sir':</span> <span class="pre">1,</span> <span class="pre">'block_hash':</span> <span class="pre">'a03ffeea35a48f0773bc993289213c3c72165ee0',</span>
<span class="pre">'uniques':</span> <span class="pre">4,</span> <span class="pre">'uniques_round':</span> <span class="pre">0,</span> <span class="pre">'forgers':</span> <span class="pre">4,</span> <span class="pre">'forgers_round':</span> <span class="pre">1,</span> <span class="pre">'count':</span> <span class="pre">0,</span> <span class="pre">'peers':</span> <span class="pre">[]'</span></code></p>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.digest_block">
<code class="descname">digest_block</code><span class="sig-paren">(</span><em>proto_block</em>, <em>from_miner=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.digest_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if the block is valid and saves it</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>proto_block</strong> – a protobuf ‘block’ object</li>
<li><strong>from_miner</strong> – True if came from a live miner (current slot)</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.genesis_block">
<code class="descname">genesis_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.genesis_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Build up genesis block info</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.insert_block">
<code class="descname">insert_block</code><span class="sig-paren">(</span><em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.insert_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves to block object in db</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block</strong> – a native PosBlock object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.last_block">
<code class="descname">last_block</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.last_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns last know block as a dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.rollback">
<code class="descname">rollback</code><span class="sig-paren">(</span><em>block_count=1</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>revert latest block_count blocks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.PosChain.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poschain.PosChain.tx_exists">
<code class="descname">tx_exists</code><span class="sig-paren">(</span><em>txid</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.PosChain.tx_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell is the given txid is in our mempool</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="data">
<dt id="poschain.SQL_DELETE_ROUND">
<code class="descclassname">poschain.</code><code class="descname">SQL_DELETE_ROUND</code><em class="property"> = 'DELETE FROM pos_chain WHERE round = ?'</em><a class="headerlink" href="#poschain.SQL_DELETE_ROUND" title="Permalink to this definition">¶</a></dt>
<dd><p>pos chain db structure</p>
</dd></dl>

<dl class="class">
<dt id="poschain.SqlitePosChain">
<em class="property">class </em><code class="descclassname">poschain.</code><code class="descname">SqlitePosChain</code><span class="sig-paren">(</span><em>verbose=False</em>, <em>db_path='data/'</em>, <em>app_log=None</em>, <em>mempool=None</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <a class="reference internal" href="#poschain.PosChain" title="poschain.PosChain"><code class="xref py py-class docutils literal notranslate"><span class="pre">poschain.PosChain</span></code></a>, <code class="xref py py-class docutils literal notranslate"><span class="pre">sqlitebase.SqliteBase</span></code></p>
<dl class="method">
<dt id="poschain.SqlitePosChain._height_status">
<code class="descname">_height_status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._height_status" title="Permalink to this definition">¶</a></dt>
<dd><p>returns a BlockHeight object with our current state</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain._last_block">
<code class="descname">_last_block</code><span class="sig-paren">(</span><em>with_tx=False</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain._last_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns last know block as a dict</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_blockinfo">
<code class="descname">async_blockinfo</code><span class="sig-paren">(</span><em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_blockinfo" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns partial height info of a given block</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_blocksync">
<code class="descname">async_blocksync</code><span class="sig-paren">(</span><em>height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_blocksync" title="Permalink to this definition">¶</a></dt>
<dd><p>returns N blocks starting with the given height.</p>
<p>FR: Harmonize. this one needs a proto as output (proto command with list of blocks)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>height</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_getaddtxs">
<code class="descname">async_getaddtxs</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_getaddtxs" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 15
returns a list of txs.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> – str: an address or address,extra</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with the txs list or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_getblock">
<code class="descname">async_getblock</code><span class="sig-paren">(</span><em>a_height</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_getblock" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 14
returns the block of the given height.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a_height</strong> – int</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with the block if exists or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_gettx">
<code class="descname">async_gettx</code><span class="sig-paren">(</span><em>params</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_gettx" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 16
returns the tx or empty protocmd.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>params</strong> – str: a transaction signature</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with the tx or None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.async_roundblocks">
<code class="descname">async_roundblocks</code><span class="sig-paren">(</span><em>a_round</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.async_roundblocks" title="Permalink to this definition">¶</a></dt>
<dd><p>Command id 13
returns all blocks of the given round.</p>
<p>FR: Harmonize. this one needs a proto as output (proto command with list of blocks)</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a_round</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">protocmd with all blocks</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.check">
<code class="descname">check</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.check" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks and creates db. This is not async yet, so we close afterward.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.delete_round">
<code class="descname">delete_round</code><span class="sig-paren">(</span><em>a_round</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.delete_round" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove round and transactions data for this round
The caller is responsible for updating state if necessary</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>a_round</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">None</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.insert_block">
<code class="descname">insert_block</code><span class="sig-paren">(</span><em>block</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.insert_block" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves to block object in db</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>block</strong> – a native PosBlock object</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.rollback">
<code class="descname">rollback</code><span class="sig-paren">(</span><em>block_count=1</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.rollback" title="Permalink to this definition">¶</a></dt>
<dd><p>revert latest block_count blocks</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.status">
<code class="descname">status</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.status" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="poschain.SqlitePosChain.tx_exists">
<code class="descname">tx_exists</code><span class="sig-paren">(</span><em>txid</em><span class="sig-paren">)</span><a class="headerlink" href="#poschain.SqlitePosChain.tx_exists" title="Permalink to this definition">¶</a></dt>
<dd><p>Tell if the given txid is in our chain</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="posclient-client-hypernode-class">
<h1>posclient - Client hypernode class<a class="headerlink" href="#posclient-client-hypernode-class" title="Permalink to this headline">¶</a></h1>
<p>WIP - A self contained client class for APIs or client line tools.</p>
<span class="target" id="module-posclient"></span><div class="section" id="pos-client-class-for-bismuth-hypernodes">
<h2>Pos client class for Bismuth HyperNodes<a class="headerlink" href="#pos-client-class-for-bismuth-hypernodes" title="Permalink to this headline">¶</a></h2>
<p>Tornado based</p>
<dl class="class">
<dt id="posclient.Posclient">
<em class="property">class </em><code class="descclassname">posclient.</code><code class="descname">Posclient</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em>, <em>verbose=False</em>, <em>wallet='poswallet.json'</em>, <em>version=''</em><span class="sig-paren">)</span><a class="headerlink" href="#posclient.Posclient" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<dl class="method">
<dt id="posclient.Posclient.action">
<code class="descname">action</code><span class="sig-paren">(</span><em>action='hello'</em>, <em>param=''</em><span class="sig-paren">)</span><a class="headerlink" href="#posclient.Posclient.action" title="Permalink to this definition">¶</a></dt>
<dd><p>Action Handler</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>action</strong> – </li>
<li><strong>param</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">The command result</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
</div>
<div class="section" id="module-base58">
<span id="base58-util-module"></span><h1>base58 - Util module<a class="headerlink" href="#module-base58" title="Permalink to this headline">¶</a></h1>
<p>Bismuth
Base58 encoding, decoding, checksum of PoS addresses</p>
<p>Adapted from various public domain sources</p>
<dl class="function">
<dt id="base58.b58decode">
<code class="descclassname">base58.</code><code class="descname">b58decode</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58decode" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode a Base58 encoded string and returns a byte object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.b58decode_int">
<code class="descclassname">base58.</code><code class="descname">b58decode_int</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58decode_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Decode a Base58 encoded string as an integer</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.b58encode">
<code class="descclassname">base58.</code><code class="descname">b58encode</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58encode" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode a string or byte object using Base58</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.b58encode_int">
<code class="descclassname">base58.</code><code class="descname">b58encode_int</code><span class="sig-paren">(</span><em>i</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.b58encode_int" title="Permalink to this definition">¶</a></dt>
<dd><p>Encode an integer using Base58</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>i</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="base58.buffer">
<code class="descclassname">base58.</code><code class="descname">buffer</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.buffer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="base58.iseq">
<code class="descclassname">base58.</code><code class="descname">iseq</code><span class="sig-paren">(</span><em>s</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.iseq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="base58.scrub_input">
<code class="descclassname">base58.</code><code class="descname">scrub_input</code><span class="sig-paren">(</span><em>v</em><span class="sig-paren">)</span><a class="headerlink" href="#base58.scrub_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Converts string to byte object</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>v</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-common">
<span id="common-util-module"></span><h1>common - Util module<a class="headerlink" href="#module-common" title="Permalink to this headline">¶</a></h1>
<p>Bismuth
Common variables and helpers for PoS</p>
<p>Also serves as config file for POC and tests</p>
<dl class="data">
<dt id="common.POC_LAST_BROADHASH">
<code class="descclassname">common.</code><code class="descname">POC_LAST_BROADHASH</code><em class="property"> = b'123456789abcdef12345'</em><a class="headerlink" href="#common.POC_LAST_BROADHASH" title="Permalink to this definition">¶</a></dt>
<dd><p>Here comes tuneable algorithm variables</p>
</dd></dl>

<dl class="function">
<dt id="common.download_file">
<code class="descclassname">common.</code><code class="descname">download_file</code><span class="sig-paren">(</span><em>url</em>, <em>filename</em><span class="sig-paren">)</span><a class="headerlink" href="#common.download_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Fetch a file from an URL with progress indicator</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>url</strong> – </li>
<li><strong>filename</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="common.first_height_is_better">
<code class="descclassname">common.</code><code class="descname">first_height_is_better</code><span class="sig-paren">(</span><em>height_a</em>, <em>height_b</em><span class="sig-paren">)</span><a class="headerlink" href="#common.first_height_is_better" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares properties of the heights to tell which one is to keep in case of forks.
Uses ‘forgers’, ‘forgers_round’, ‘uniques’, ‘uniques_round’, ‘round’, ‘height’</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>height_a</strong> – </li>
<li><strong>height_b</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean, True if a is &gt; b</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="common.heights_match">
<code class="descclassname">common.</code><code class="descname">heights_match</code><span class="sig-paren">(</span><em>height_a</em>, <em>height_b</em><span class="sig-paren">)</span><a class="headerlink" href="#common.heights_match" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks if simulated height_b fits the predicate height_a
only checks the current round info, not the whole chain.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>height_a</strong> – a height dict</li>
<li><strong>height_b</strong> – a height dict</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="common.ipport_to_fullpeer">
<code class="descclassname">common.</code><code class="descname">ipport_to_fullpeer</code><span class="sig-paren">(</span><em>ip</em>, <em>port</em><span class="sig-paren">)</span><a class="headerlink" href="#common.ipport_to_fullpeer" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="common.peer_to_fullpeer">
<code class="descclassname">common.</code><code class="descname">peer_to_fullpeer</code><span class="sig-paren">(</span><em>peer</em><span class="sig-paren">)</span><a class="headerlink" href="#common.peer_to_fullpeer" title="Permalink to this definition">¶</a></dt>
<dd><p>converts a tuple (address, ip, port, active) to a string ip:0port</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>peer</strong> – </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="common.same_height">
<code class="descclassname">common.</code><code class="descname">same_height</code><span class="sig-paren">(</span><em>peer_status</em>, <em>our_status</em><span class="sig-paren">)</span><a class="headerlink" href="#common.same_height" title="Permalink to this definition">¶</a></dt>
<dd><p>Compares not only the height but the whole properties, including Round, Slot In Round and block hash.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>peer_status</strong> – </li>
<li><strong>our_status</strong> – </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last">Boolean</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="common.update_source">
<code class="descclassname">common.</code><code class="descname">update_source</code><span class="sig-paren">(</span><em>url</em>, <em>app_log=None</em><span class="sig-paren">)</span><a class="headerlink" href="#common.update_source" title="Permalink to this definition">¶</a></dt>
<dd><p>Update source file from an url</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>url</strong> – url of the tgz archive</li>
<li><strong>app_log</strong> – optional log handler</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"></p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h3><a href="index.html">Table Of Contents</a></h3>
<p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">&gt; Modules</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#poshn-core-hypernode-class">poshn - core hypernode class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#poschain-pos-chain-abstraction-class">poschain - PoS chain abstraction class</a></li>
<li class="toctree-l1"><a class="reference internal" href="#posclient-client-hypernode-class">posclient - Client hypernode class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#pos-client-class-for-bismuth-hypernodes">Pos client class for Bismuth HyperNodes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#module-base58">base58 - Util module</a></li>
<li class="toctree-l1"><a class="reference internal" href="#module-common">common - Util module</a></li>
<li class="toctree-l1"><a class="reference internal" href="poc.html">&gt; Bismuth Hypernodes</a></li>
<li class="toctree-l1"><a class="reference internal" href="poc.html#module-hn_instance">hn_instance: HyperNode instance</a></li>
<li class="toctree-l1"><a class="reference internal" href="poc.html#module-hn_client">hn_client: HyperNode Client</a></li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="index.html"
                        title="previous chapter">Welcome to Bismuth Hypernodes’s documentation!</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="poc.html"
                        title="next chapter">&gt; Bismuth Hypernodes</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="poc.html" title="&gt; Bismuth Hypernodes"
             >next</a> |</li>
        <li class="right" >
          <a href="index.html" title="Welcome to Bismuth Hypernodes’s documentation!"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="index.html">Bismuth Hypernodes 0.1 documentation</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Bismuth Foundation.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>